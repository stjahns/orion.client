<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<script src="../../orion/Deferred.js"></script>
	<script src="../../orion/plugin.js"></script>
	<script>
	/*global window orion*/
		window.onload = function() {
			var provider = new orion.PluginProvider();
			provider.registerService(["test"], {
				test: function(echo) {
					return echo;
				},
				testPromise: function(echo) {
					var d = new orion.Deferred();
					window.setTimeout(function() {
						d.progress("progress");
						d.resolve(echo);
					},0);
					return d;
				},
				testEvent: function(name) {
					this.dispatchEvent(name, name + "test");
				},
				dispatchEvent: function(eventName) {
					// the plugin infrastructure will chain this
				}
			}, {name : "echotest"});
			provider.connect();
		};
	</script>
</head>
<body>
</body>
</html>